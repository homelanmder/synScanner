id: nacos-jraftserver-deserialization-rce

info:
  name: Nacos jraft - 反序列化命令执行漏洞
  author: wintry
  severity: critical
  description: 当处理某些基于Jraft的请求时，Nacos使用Hessian进行反序列化，但没有设置限制，导致应用程序中的远程代码执行(RCE)漏洞. 
  reference: https://stack.chaitin.com/techblog/detail?id=106
  tags: nacos
  metadata:
    max-request: 1

http:
  - method: GET
    path:
      - "{{BaseURL}}/nacos/v1/console/server/state"
      - "{{BaseURL}}/v1/console/server/state"
    matchers-condition: or
    matchers:
      - type: word
        words:
          - '"standalone_mode":"cluster"'
        part: body
      - type: regex
        regex:
          - '"version":"2\..*?"'
        part: body